---
title: "R Notebook"
output: html_notebook
---

Diamond dataset is inside the ggplot library.

```{r}
library(ggplot2)
data=diamonds
```

```{r}
#Getting structure of Diamond dataset
str(data)
```
 Cut, Color and Clarity are factor variables and other are numerical variables.
 
```{r}
# Histogram of price 
ggplot(aes(x=price),data=diamonds)+geom_histogram()
```
 Histogram is skewed right skewed.
 
```{r}
#Summary statistics 
summary(diamonds$price)
```
 
 Answering the following questions 
1. How many cost less than U$500?
2. How many cost less than U$250?
3. How many cost equal to U$15,000 or more?

```{r}
#Cost less than US$500
sum(diamonds$price<500)
```
```{r}
#Cost less than US$250
sum(diamonds$price<250)
```
```{r}
#cost equal to U$15,000 or more
sum(diamonds$price>=15000)
```
```{r}
# Explore the largest peak in the
ggplot(aes(x=price),data=diamonds)+geom_histogram(binwidth = 1000,col='red')+ggtitle('Histogram of the price')+ylab('Frequency')+xlab('Diamond price')
```
```{r}
# Break out the histogram of diamond prices by cut.
ggplot(aes(x=price),data=diamonds)+geom_histogram(binwidth = 500,col='red')+ggtitle('Histogram of the price')+ylab('Frequency')+xlab('Diamond price')+facet_wrap(~cut)+theme_minimal()
```
```{r}
#Higest price diamond
subset(diamonds,price==max(price))
```

Premimum cut has maximum price diamond.

```{r}
#Lowest Price Diamond
subset(diamonds,price==min(price))
```
Ideal and premium has lowest price diamonds.

To find lowest mean of the diamond cuts 
```{r}
#Subsetting the diamonds by cut
Fair = diamonds[which(diamonds$cut == "Fair"),]
Good = diamonds[which(diamonds$cut == "Good"),]
VaryGood = diamonds[which(diamonds$cut == "Very Good"),]
Premium = diamonds[which(diamonds$cut == "Premium"),]
Ideal = diamonds[which(diamonds$cut == "Ideal"),]

```

```{r}
mean(Fair$price)
```
```{r}
mean(Good$price)
```
```{r}
mean(VaryGood$price)
```
```{r}
mean(Premium$price)
```
```{r}
mean(Ideal$price)
```

In the previous histogram, Scles of y was same for all the cuts. So it was hard to interpret from graph. Now we are changing the scale by just adding scales=free_y

```{r}
ggplot(aes(x=price),data=diamonds)+geom_histogram(binwidth = 500,col='red')+ggtitle('Histogram of the price')+ylab('Frequency')+xlab('Diamond price')+facet_wrap(~cut,scales="free_y")+theme_minimal()
```
 Now figure out price per caret by cut.
```{r}
#Histogram of price per caret by cut
ggplot(aes(x=price/carat),data=diamonds)+geom_histogram(binwidth = 500,col='red')+ggtitle('Histogram of the price per carat')+ylab('Frequency')+xlab('Diamond price per carat')+facet_wrap(~cut,scales="free_y")+theme_minimal()
```
 
 Using log10 for x 
```{r}
ggplot(aes(x=price/carat),data=diamonds)+geom_histogram(binwidth = 0.1,col='red')+ggtitle('Histogram of the price per carat')+ylab('Frequency')+xlab('Diamond price per carat')+facet_wrap(~cut,scales="free_y")+theme_minimal()+scale_x_log10()
```
 
 
 
```{r}
#Plot price and carat by cut
ggplot(aes(x=price,y=carat),data=diamonds)+geom_line()+ylab('carat')+xlab('Diamond price')+facet_wrap(~cut,scales="free_y")+theme_minimal()
```
 
 Now it's term of some interesting boxplots 
 
